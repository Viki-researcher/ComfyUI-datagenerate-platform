# 平台一键启动脚本环境变量示例
# 用法：
#   cp .env.platform.example .env.platform
#   然后按需修改路径/端口/数据库连接

# ===== 代码路径（建议不改，除非你移动了目录）=====
COMFULUI_ROOT="/home/admin1/ai02/codeyard/wk_codeyard/Code_backup/ComfulUI"
ART_FRONTEND_DIR="${COMFULUI_ROOT}/art-design-pro"
BACKEND_DIR="${COMFULUI_ROOT}/vue-fastapi-admin-main"
COMFYUI_REPO_PATH="${COMFULUI_ROOT}/ComfyUI-master-fitow"

# ===== 服务监听 =====
# 局域网访问：绑定到 0.0.0.0，然后用本机 IP 访问（例如 http://10.10.1.199:3006）
FRONTEND_HOST="0.0.0.0"
FRONTEND_PORT="3006"
BACKEND_HOST="0.0.0.0"
BACKEND_PORT="9999"

# ===== Python 可执行文件（双 conda 环境）=====
BACKEND_PY="/home/admin1/miniconda3/envs/datagen-backend/bin/python"
COMFYUI_PYTHON="/home/admin1/miniconda3/envs/datagen-comfyui/bin/python"

# ===== 后端数据库（开发先用 sqlite；上生产换 postgres）=====
DB_DEFAULT_CONNECTION="sqlite"
# DB_HOST="127.0.0.1"
# DB_PORT="5432"
# DB_USER="datagen"
# DB_PASSWORD="datagen"
# DB_DATABASE="datagen"

# ===== ComfyUI 实例管理（后端读取这些 env）=====
# ComfyUI 对外监听地址（局域网访问建议 0.0.0.0）
COMFYUI_LISTEN="0.0.0.0"
# 后端内部访问 ComfyUI 的 host（健康检查 /history 用）。一般无需改，留空会自动推导为 127.0.0.1
COMFYUI_INTERNAL_HOST=""
# 前端打开 ComfyUI 的对外基地址（不带端口）。例如：http://10.10.1.199
COMFYUI_PUBLIC_BASE_URL="http://10.10.1.199"
COMFYUI_PORT_RANGE="8200-8299"
COMFYUI_INSTANCE_BASE_DIR="runtime/comfy_instances"
COMFYUI_LOG_DIR="runtime/comfy_logs"
COMFYUI_STARTUP_TIMEOUT_SECONDS="240"
COMFYUI_HEARTBEAT_INTERVAL_SECONDS="30"
COMFYUI_HISTORY_SYNC_INTERVAL_SECONDS="10"

# CPU 环境建议开启：自动追加 `--cpu`（避免 CPU-only torch 报 CUDA 断言）
COMFYUI_FORCE_CPU="true"

# ===== ComfyUI -> 平台回调（可选）=====
# 注意：一旦配置 secret，ComfyUI 自定义节点 PlatformCallback 会用它回调后端写入 generation_logs
PLATFORM_INTERNAL_SECRET="devsecret"
PLATFORM_CALLBACK_URL="http://127.0.0.1:9999/api/internal/comfy/callback"

# ===== 前端可选 env（仅用于脚本启动时注入；也可以直接改 art-design-pro/.env.*）=====
VITE_API_PROXY_URL="http://127.0.0.1:9999"
VITE_DISABLE_DRAG_VERIFY="true"

